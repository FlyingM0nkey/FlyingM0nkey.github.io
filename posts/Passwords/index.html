<!DOCTYPE html><html lang="en" mode="dark" > <!-- The Head v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Password Cracking | Flying_M0nkey</title><meta name="generator" content="Jekyll v4.1.1" /><meta property="og:title" content="Password Cracking" /><meta name="author" content="Flying_M0nkey" /><meta property="og:locale" content="en_US" /><meta name="description" content="Password cracking, brute forcing and wordlist creation are an important part of infosec, from doing CTF’s as a hobby or as a professional pentester, having a solid methodology to giving yourself the best chance crack a password or hash is a vital skill. These notes are not set in stone and not all encompassing. If you see a mistake or have a suggestion for the page, please contact me on Discord at Buter#2867" /><meta property="og:description" content="Password cracking, brute forcing and wordlist creation are an important part of infosec, from doing CTF’s as a hobby or as a professional pentester, having a solid methodology to giving yourself the best chance crack a password or hash is a vital skill. These notes are not set in stone and not all encompassing. If you see a mistake or have a suggestion for the page, please contact me on Discord at Buter#2867" /><link rel="canonical" href="protocol://flyingm0nkey.github.io/posts/Passwords/" /><meta property="og:url" content="protocol://flyingm0nkey.github.io/posts/Passwords/" /><meta property="og:site_name" content="Flying_M0nkey" /><meta property="og:image" content="protocol://flyingm0nkey.github.io/assets/img/Pass/cat_logo.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-09-22T18:08:00+08:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="protocol://flyingm0nkey.github.io/assets/img/Pass/cat_logo.png" /><meta property="twitter:title" content="Password Cracking" /><meta name="twitter:site" content="@twitter_is_the_devil" /><meta name="twitter:creator" content="@Flying_M0nkey" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"Password cracking, brute forcing and wordlist creation are an important part of infosec, from doing CTF’s as a hobby or as a professional pentester, having a solid methodology to giving yourself the best chance crack a password or hash is a vital skill. These notes are not set in stone and not all encompassing. If you see a mistake or have a suggestion for the page, please contact me on Discord at Buter#2867","headline":"Password Cracking","dateModified":"2020-09-22T18:08:00+08:00","datePublished":"2020-09-22T18:08:00+08:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"protocol://flyingm0nkey.github.io/posts/Passwords/"},"image":"protocol://flyingm0nkey.github.io/assets/img/Pass/cat_logo.png","url":"protocol://flyingm0nkey.github.io/posts/Passwords/","author":{"@type":"Person","name":"Flying_M0nkey"},"@context":"https://schema.org"}</script> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT license --><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"> <!-- CSS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" async></script> <!-- JS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --> <script src="/assets/js/post.min.js" async></script> <script src="/app.js" defer></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">Flying_M0nkey</a></div><div class="site-subtitle font-italic">A desperate attempt to store my notes where I can find them.</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></li></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <a href="https://github.com/FlyingM0nkey" target="_blank"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_is_the_devil" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:window.open('mailto:' + ['nobody_uses','email.com'].join('@'))" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" > <i class="fas fa-rss"></i> </a></div></div><!-- The Top Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Password Cracking</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"> <!-- Refactor the HTML structure. --> <!-- Suroundding the markdown table with '<div class="table-wrapper">. and '</div>' --> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Password Cracking</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, Sep 22, 2020, 6:08 PM +0800" > Sep 22 <i class="unloaded">2020-09-22T18:08:00+08:00</i> </span> by <span class="author"> Flying_M0nkey </span></div><div> Updated <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Mon, Nov 9, 2020, 2:03 PM -0500" > Nov 9 <i class="unloaded">2020-11-10T03:03:52+08:00</i> </span></div></div><div class="post-content"> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/Pass/cat_logo.png" class="post-preview-img"><p>Password cracking, brute forcing and wordlist creation are an important part of infosec, from doing CTF’s as a hobby or as a professional pentester, having a solid methodology to giving yourself the best chance crack a password or hash is a vital skill. These notes are not set in stone and not all encompassing. If you see a mistake or have a suggestion for the page, please contact me on Discord at <strong><em>Buter#2867</em></strong></p><h2 id="basic-everyday-cracking">Basic Everyday Cracking</h2><p>Just so we have a hash to play with, I’ll generate an md5 hash of the word ‘passw0rd’.</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">echo</span> <span class="nt">-n</span> <span class="s2">"passw0rd"</span> | <span class="nb">md5sum</span> <span class="o">&gt;</span> hash.txt
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/Pass/1_make_hash.png" alt="make_hash" /></p><p>We know this is an md5 hash, but you’ll always have to check the type of hash you are trying to crack. My tool for this is <a href="https://github.com/psypanda/hashID">hashid.py</a>. I like this tool because it does a good job of identifying the hash and will also give you the Hashcat and JTR code if you ask for it with -m and -j respectively.</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>./hashid.py <span class="nt">-m</span> <span class="nt">-j</span> <span class="s1">'bed128365216c019988915ed3add75fb'</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/Pass/2_hashid.py.png" alt="Hash_id" /></p><p>Another method to quickly identify the hash I stole from Ippsec:</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>hashcat <span class="nt">--example-hashes</span> | <span class="nb">grep</span> <span class="s1">'$2a$05'</span> <span class="nt">-B5</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/Pass/ippy.png" alt="Ippy" /></p><p>We get a list of possible hashes so a bit of common sense comes into play, here. The first Hashcat code is for a raw md5, which is what we know it is, and it has a code of 0.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/Pass/cat_logo.png" alt="Cat" /></p><p>We will now try to crack the hash with <strong><em>Hashcat</em></strong> by specifying the hash file and the wordlist we want to use, rockyou.txt in this case. I am using my Kali machine, so we need to use <strong><em>–force</em></strong> to force it to use the CPU and we’ll use -a 0 for a straight attack.</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>hashcat <span class="nt">--force</span> <span class="nt">-m</span> 0 <span class="nt">-a</span> 0 hash.txt rockyou.txt
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/Pass/3_hashcat.png" alt="Hashcat" /></p><p>After it shows us a couple of warnings about using –force, it takes a few seconds to sort it’s life out and then starts the cracking, which takes it less than a second.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/Pass/jtr_logo.png" alt="John_logo" /> Now let’s try the same attack with <strong><em>John The Ripper</em></strong>.</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>john <span class="nt">--wordlist</span><span class="o">=</span>rockyou.txt <span class="nt">--format</span><span class="o">=</span>raw-md5 hash.txt
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/Pass/jtr.png" alt="JTR" /></p><p>John cracked it in less than a second as well. It’s worth noting that if you try to crack it again, you won’t get the output as JTR will have stored the cracked hash in the pot file at <strong>/root/.john/john.pot</strong>. You will need to erase the file to crack it again, or cat the file to see the password.</p><h2 id="hydra-attacks">Hydra Attacks</h2><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/Pass/hydra_logo.png" alt="Hydra" /></p><p>I won’t lie, Hydra is a finicky little fella, so getting the syntax right is vital and I certainly seem to get it wrong more often than I get it right on certain attacks. Note the use of upper/lower case; -p password vs. -P password.txt.</p><p>The -t flag specifies the number of threads you are running in the attack. For ssh I commonly use 4. For other services I will use trial and error to find a good number.</p><p>If the service you are attacking is running on a <em>non-standard</em> port, you must specify that with the -s flag. ex: ftp is running on port 1021, the end of the attack would look be <strong>ftp -s 1021</strong></p><p><strong>Hydra Options:</strong></p><ul><li>-l Single username</li><li>-L Username list</li><li>-p Password</li><li>-P Password list</li><li>-t Threads</li><li>-V Verbose output</li><li>-f Stop when valid login found</li><li>-s Specific port</li></ul><p><strong>HTTP(s) Post Form</strong></p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>hydra <span class="nt">-l</span> admin <span class="nt">-P</span> rockyou.txt <span class="nv">$ip</span> http-post-form <span class="s1">'&lt;Login Page&gt;:&lt;Request Body&gt;:&lt;Error Message&gt;'</span> <span class="nt">-V</span>
</pre></table></code></div></div><p><strong>FTP</strong></p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>hydra <span class="nt">-t</span> 1 <span class="nt">-l</span> user <span class="nt">-P</span> rockyou.txt <span class="nt">-vV</span> <span class="nv">$ip</span> ftp
</pre></table></code></div></div><p><strong>SSH</strong></p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>hydra <span class="nt">-v</span> <span class="nt">-V</span> <span class="nt">-u</span> <span class="nt">-l</span> user <span class="nt">-P</span> rockyou.txt <span class="nt">-t</span> 4 <span class="nt">-u</span> <span class="nv">$ip</span> ssh
</pre></table></code></div></div><p><strong>POP3</strong></p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>hydra <span class="nt">-l</span> user <span class="nt">-P</span> rockyou.txt <span class="nt">-f</span> <span class="nv">$ip</span> pop3 <span class="nt">-V</span> <span class="nt">-t</span> 1
</pre></table></code></div></div><p><strong>Wordpress</strong></p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>hydra <span class="nt">-l</span> user <span class="nt">-P</span> rockyou.txt <span class="nv">$ip</span> <span class="nt">-V</span> http-form-post <span class="s1">'/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log In&amp;testcookie=1:S=Location'</span>
</pre></table></code></div></div><p><strong>WPscan for Wordpress</strong></p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>wpscan <span class="nt">--url</span> <span class="nv">$ip</span> <span class="nt">-U</span> user <span class="nt">-P</span> rockyou.txt
</pre></table></code></div></div><p><strong>Windows RDP</strong></p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>hydra <span class="nt">-t</span> 1 <span class="nt">-V</span> <span class="nt">-f</span> <span class="nt">-l</span> user <span class="nt">-P</span> rockyou.txt rdp://<span class="nv">$ip</span>
</pre></table></code></div></div><p><strong>SMB</strong></p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>hydra <span class="nt">-t</span> 1 <span class="nt">-V</span> <span class="nt">-f</span> <span class="nt">-l</span> user <span class="nt">-P</span> rockyou.txt <span class="nv">$ip</span> smb
</pre></table></code></div></div><p><strong>401 Auth</strong></p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>hydra <span class="nt">-l</span> user <span class="nt">-P</span> rockyou.txt <span class="nv">$ip</span> http-get /path
</pre></table></code></div></div><p><strong>SNMP</strong></p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>hydra <span class="nt">-P</span> rockyou.txt <span class="nt">-v</span> <span class="nv">$ip</span> snmp
</pre></table></code></div></div><p><strong>MYSQL</strong></p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>hydra <span class="nt">-l</span> user <span class="nt">-P</span> rockyou.txt <span class="nv">$ip</span> mysql <span class="nt">-V</span> <span class="nt">-f</span>
</pre></table></code></div></div><p><strong>VNC</strong></p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>hydra <span class="nt">-P</span> rockyou.txt <span class="nv">$ip</span> vnc <span class="nt">-V</span>
</pre></table></code></div></div><h2 id="zip-passwords">Zip Passwords</h2><p>Zip files can have passwords set on them, but we have a way to crack those, too! We will use JTR for this as it seems to be a bit more forgiving, but first, we need to create a hash that John can understand and zip2john can do this for us.</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>zip2john tom.zip | <span class="nb">cut</span> <span class="nt">-d</span> <span class="s1">':'</span> <span class="nt">-f</span> 2 <span class="o">&gt;</span> hash.txt
</pre></table></code></div></div><p>Then use john to crack the zip password.</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>john hash.txt <span class="nt">--format</span><span class="o">=</span>PKZIP <span class="nt">--wordlist</span><span class="o">=</span>/root/RockYou/rockyou.txt
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/Pass/zippy.png" alt="Zip" /></p><p>Hashcat may also be used to crack the zip password, but the hash may need to be modified as per the example on the hashcat example page. <a href="https://hashcat.net/wiki/doku.php?id=example_hashes">https://hashcat.net/wiki/doku.php?id=example_hashes</a></p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>hashcat <span class="nt">-a</span> 0 <span class="nt">-m</span> 17200 hashes.txt rockyou.txt
</pre></table></code></div></div><p>A third, possibly more elegant, solution is fcrackzip. Simply install it with:</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>apt <span class="nb">install </span>fcrackzip
</pre></table></code></div></div><p>Then run it. Here I will use the rockyou.txt wordlist again.</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>fcrackzip <span class="nt">-D</span> <span class="nt">-p</span> /root/RockYou/rockyou.txt file.zip
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/Pass/fcrack.png" alt="Fcrack" /></p><h2 id="linux-passwords">Linux Passwords</h2><p>Linux passwords are kept in the /etc/shadow file, not the /etc/passwd file. To crack them easily, we need to “unshadow” them. For that we will need the passwd and the shadow file. I’ve created a user <em>unicorn</em> with password <em>password</em> to illustrate.</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>unshadow test_passwd.txt test_shadow.txt <span class="o">&gt;</span> test.txt
hashcat <span class="nt">--force</span> <span class="nt">-m</span> 1800 <span class="nt">-a</span> 0 test.txt rockyou.txt
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/Pass/shadow1.png" alt="Shadow1" /> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/Pass/shadow2.png" alt="Shadow2" /></p><h2 id="ssh-key-encryption">SSH Key Encryption</h2><p>Getting an SSH key to a machine is always pretty cool. Well, until you try to use it and find out it’s encrypted and you don’t have the password. John The Ripper comes to our rescue again. Like a zip file, we need to get the file into a format that JTR can read, so we will use ssh2john.py.</p><p>Here we have recovered a private key, but it clearly says it’s encrypted. If we try to use it, we will be asked for a password.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/Pass/ssh1.png" alt="SSH1" /></p><p>I can’t remember where ssh2john lives, so I locate it and use it’s full path from my RockYou directory. Once ssh2john has run, we can use JTR to crack the password as usual.</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>python /usr/share/john/ssh2john.py id_rsa <span class="o">&gt;</span> id_john
john id_john <span class="nt">--wordlist</span><span class="o">=</span>rockyou.txt
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/Pass/ssh2.png" alt="SSH2" /></p><p>John cracks the password to <strong><em>superpassword</em></strong> so this key may now be used to login.</p><p>Top tip from Mr. Ippsec in his <a href="https://www.youtube.com/watch?v=A4U3xiRWfsU">Tenten video</a> is to use <a href="https://github.com/stricture/hashstack-server-plugin-jtr/blob/master/scrapers/sshng2john.py">sshng2john</a> if you are using JumboJohn to crack.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/notes/'>Notes</a>, <a href='/categories/passwords/'>Passwords</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/passwords/" class="post-tag no-text-decoration" >Passwords</a> <a href="/tags/hashcat/" class="post-tag no-text-decoration" >Hashcat</a> <a href="/tags/jtr/" class="post-tag no-text-decoration" >JTR</a> <a href="/tags/crunch/" class="post-tag no-text-decoration" >Crunch</a> <a href="/tags/cewl/" class="post-tag no-text-decoration" >Cewl</a> <a href="/tags/ssh2john/" class="post-tag no-text-decoration" >ssh2john</a> <a href="/tags/hydra/" class="post-tag no-text-decoration" >Hydra</a> <a href="/tags/zip2john/" class="post-tag no-text-decoration" >zip2john</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><!-- Post sharing snippet v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Password Cracking - Flying_M0nkey&url=protocol://FlyingM0nkey.github.io/posts/Passwords/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Password Cracking - Flying_M0nkey&u=protocol://FlyingM0nkey.github.io/posts/Passwords/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Password Cracking - Flying_M0nkey&url=protocol://FlyingM0nkey.github.io/posts/Passwords/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><!-- The Pannel on right side (Desktop views) v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><h3 data-toc-skip>Recent Update</h3><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Passwords/">Password Cracking</a></li><li><a href="/posts/Blackfield/">Blackfield [HTB]</a></li><li><a href="/posts/Devel/">Devel [HTB]</a></li><li><a href="/posts/Legacy/">Legacy [HTB]</a></li><li><a href="/posts/BOF/">Buffer Overflow Demo</a></li></ul></div><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/walkthrough/">Walkthrough</a> <a class="post-tag" href="/tags/jtr/">JTR</a> <a class="post-tag" href="/tags/hashcat/">Hashcat</a> <a class="post-tag" href="/tags/htb/">HTB</a> <a class="post-tag" href="/tags/zip2john/">zip2john</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/smb/">SMB</a> <a class="post-tag" href="/tags/passwords/">Passwords</a> <a class="post-tag" href="/tags/metasploit/">Metasploit</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2 mb-2">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <!-- Recommend the other 3 posts according to the tags and categories of the current post, if the number is not enough, use the other latest posts to supplement. v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/PMKID/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Oct 7 <i class="unloaded">2020-10-07T18:08:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>WiFi PMKID Capture</h3><div class="text-muted small"><p> Even in 2020 it is still easy to steal WiFi credentials. The video at the bottom is almost entirely in real time. With a 10,000 word long wordlist, it took far longer to write these notes than it d...</p></div></div></a></div><div class="card"> <a href="/posts/Funbox2/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Sep 22 <i class="unloaded">2020-09-22T18:08:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Funbox 2 [Vulnhub]</h3><div class="text-muted small"><p> Funbox 2 is another quick box if you are familiar with cracking zip passwords and don’t spend too long down the rabbit hole! Enumeration My standard nmap scan: nmap -sc -sV -p- $ip 3 ports op...</p></div></div></a></div><div class="card"> <a href="/posts/Blackfield/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Nov 7 <i class="unloaded">2020-11-07T18:08:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Blackfield [HTB]</h3><div class="text-muted small"><p> Blackfield was a really fun Active Directory machine with many steps required to be able to read the root flag. The writeup and the video differ slightly as I learned a few more things after I had ...</p></div></div></a></div></div></div><!-- Navigation buttons at the bottom of the post. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Funbox2/" class="btn btn-outline-primary"><p>Funbox 2 [Vulnhub]</p></a> <a href="/posts/CewlKid/" class="btn btn-outline-primary"><p>CewlKId [Vulnhub]</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script> <!-- The Footer v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2020 <a href="https://github.com/FlyingM0nkey">King_Kong</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/">Chirpy</a> theme.</p></div></div></footer></div><!-- The Search results v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/walkthrough/">Walkthrough</a> <a class="post-tag" href="/tags/jtr/">JTR</a> <a class="post-tag" href="/tags/hashcat/">Hashcat</a> <a class="post-tag" href="/tags/htb/">HTB</a> <a class="post-tag" href="/tags/zip2john/">zip2john</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/smb/">SMB</a> <a class="post-tag" href="/tags/passwords/">Passwords</a> <a class="post-tag" href="/tags/metasploit/">Metasploit</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <!-- The GA snippet v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', '', 'auto'); ga('send', 'pageview'); </script> <!-- Jekyll Simple Search loader v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="protocol://FlyingM0nkey.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
